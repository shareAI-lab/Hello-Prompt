# Hello Prompt - 产品需求文档 V1.0
**版本：V1.0**  
**日期：2025-07-25**  
**状态：开发版本**

## 1. 产品概述

### 1.1 产品定义
Hello Prompt是一款极简的macOS语音到AI提示词转换工具。用户通过快捷键激活语音输入，系统将语音转换为专业的AI提示词，并提供美观的确认界面。

**核心价值**：将模糊的语音想法转换为精确的AI提示词，3秒内完成整个流程。

### 1.2 目标用户
- **开发者**：在IDE中快速生成代码提示词
- **设计师**：快速生成图像创作提示词
- **内容创作者**：生成文章写作提示词

### 1.3 核心功能特性
- 全局快捷键启动语音录制
- 智能语音活动检测(VAD)
- OpenAI API集成(Whisper + GPT-4)
- 半透明美观的结果展示界面
- 一键确认插入到光标位置
- 语音修改功能
- 开机自启动

## 2. 用户体验流程

### 2.1 主流程设计
```
1. 用户按快捷键 (默认Ctrl+M)
   ↓
2. 显示录音悬浮球，开始录制
   ↓
3. 用户语音输入想法
   ↓
4. 自动检测静音停止录制(500ms静音)
   ↓
5. 显示处理状态(1-3秒)
   ↓
6. 显示半透明结果蒙版
   ┌────────────────────────────────────────┐
   │              提示词结果                  │
   │                                        │
   │  创建一个React登录组件，要求如下：         │
   │  1. 使用TypeScript类型定义              │
   │  2. 包含用户名和密码输入框               │
   │  3. 实现表单验证功能                    │
   │  4. 支持记住登录状态                    │
   │  5. 响应式设计适配移动端                │
   │                                        │
   │  [确认插入 ↵]    [语音修改 Space]        │
   └────────────────────────────────────────┘
   ↓
7. 用户选择确认或修改
```

### 2.2 语音修改流程
```
用户在结果界面按Space键
   ↓
蒙版变为修改模式，显示录音状态
   ↓
用户说修改需求: "加上忘记密码功能"
   ↓
系统处理修改请求
   ↓
显示完整修改后的提示词
   ↓
用户确认或继续修改
```

### 2.3 首次配置流程
```
1. 应用首次启动
   ↓
2. 显示欢迎界面
   ┌─────────────────────────────────────┐
   │        欢迎使用 Hello Prompt          │
   │                                     │
   │   快速配置，开始使用语音输入AI提示词    │
   │                                     │
   │   OpenAI API 配置                   │
   │   Base URL: [api.openai.com    ]    │
   │   API Token: [sk-************   ]    │
   │                                     │
   │   全局快捷键: [Ctrl+M] [修改]        │
   │                                     │
   │   ☑ 开机自动启动                     │
   │                                     │
   │         [测试连接] [开始使用]          │
   └─────────────────────────────────────┘
   ↓
3. 用户填写配置
   ↓
4. 测试API连接
   ↓
5. 配置完成，应用最小化到菜单栏
```

## 3. 界面设计规范

### 3.1 录音悬浮球
**设计要求**：
- 直径：40px
- 位置：屏幕中下方，距离边缘20px
- 动画：脉动效果，录音时红色，待机时绿色
- 材质：半透明毛玻璃效果
- 行为：录音完成后淡出
- 参考评估Siri光球的效果和行为表现，外观表现等。

**状态指示**：
- 待机：绿色，轻微脉动
- 录音中：红色，明显脉动
- 处理中：橙色，旋转动画
- 错误：红色，闪烁一次后消失

### 3.2 结果展示蒙版
**设计要求**：
- 覆盖整个屏幕，半透明背景(黑色20%透明度)
- 中央卡片：宽度最大600px，高度自适应
- 材质：毛玻璃效果(NSVisualEffectView)
- 圆角：12px
- 阴影：0 8px 32px rgba(0,0,0,0.12)

**内容布局**：
```
┌──────────────────────────────────────────────┐
│  提示词内容区域                                │
│  ┌────────────────────────────────────────┐   │
│  │ 可滚动文本区域                          │   │
│  │ 字体：SF Pro Display                   │   │
│  │ 大小：16px                             │   │
│  │ 行高：1.5                              │   │
│  │ 最大高度：400px                        │   │
│  └────────────────────────────────────────┘   │
│                                              │
│  按钮区域                                    │
│  ┌─────────────────┐  ┌─────────────────┐   │
│  │ 确认插入 (↵)     │  │ 语音修改 (Space) │   │
│  │ 蓝色主按钮       │  │ 灰色次要按钮     │   │
│  └─────────────────┘  └─────────────────┘   │
│                                              │
│  底部状态栏                                  │
│  处理时间: 1.2s   字数: 128                  │
└──────────────────────────────────────────────┘
```

### 3.3 设置界面
**设计要求**：
- 窗口尺寸：500×400px
- 不可调整大小
- 居中显示
- 标签页式布局：基础设置、高级设置、关于

**基础设置页面**：
```
┌─────────────────────────────────────────┐
│ API 配置                                │
│ Base URL  [https://api.openai.com   ]  │
│ API Token [sk-********************* ]  │
│ [测试连接]                              │
│                                        │
│ 快捷键配置                              │
│ 录制快捷键 [Ctrl+M] [录制新快捷键]       │
│                                        │
│ 启动设置                                │
│ ☑ 开机自动启动                          │
│ ☑ 启动时最小化到菜单栏                   │
└─────────────────────────────────────────┘
```

## 4. 功能需求详细定义

### 4.1 语音录制功能
**功能描述**：通过全局快捷键启动语音录制，智能检测语音活动

**详细需求**：
- 支持自定义全局快捷键(默认Ctrl+M)
- 启动后显示录音悬浮球
- 实时语音活动检测(VAD)
- 自动停止录制(500ms静音检测)
- 手动停止录制(再次按快捷键或ESC)
- 音频格式：16kHz单声道，适合OpenAI API
- 最大录音时长：500秒(防止误操作)

**验收标准**：
- 快捷键响应时间 ≤ 100ms
- VAD检测准确率 ≥ 95%
- 录音音质清晰，无明显噪音

### 4.2 AI处理功能
**功能描述**：将录制的音频转换为文本，再优化为专业AI提示词

**详细需求**：
- 使用OpenAI Whisper API进行语音识别
- 支持中英文混合识别
- 使用GPT-4进行提示词优化
- 根据上下文(当前应用)调整优化策略
- 处理时间控制在3秒内
- 支持API配置(Base URL + Token)

**验收标准**：
- 语音识别准确率 ≥ 95%
- 提示词优化质量评分 ≥ 85%
- API调用成功率 ≥ 99%
- 端到端处理时间 ≤ 3秒

### 4.3 结果展示功能
**功能描述**：以美观的半透明蒙版展示优化后的提示词

**详细需求**：
- 半透明全屏蒙版覆盖
- 中央卡片展示提示词内容
- 支持文本滚动(内容超过400px高度)
- 两个操作按钮：确认插入、语音修改
- 键盘快捷键：Enter确认、Space修改、ESC取消
- 点击蒙版空白区域取消

**验收标准**：
- 界面美观符合macOS设计规范
- 操作响应流畅，无卡顿
- 快捷键响应准确

### 4.4 文本插入功能
**功能描述**：将确认的提示词插入到当前光标位置

**详细需求**：
- 自动检测当前活跃应用和光标位置
- 支持主流应用：Xcode、VS Code、Sublime、Terminal、浏览器等
- 使用系统剪贴板或可访问性API插入文本
- 插入后自动聚焦到原应用
- 插入完成后显示成功提示

**验收标准**：
- 支持应用覆盖率 ≥ 95%
- 插入成功率 ≥ 99%
- 插入后光标位置正确

### 4.5 语音修改功能
**功能描述**：通过语音输入修改需求，系统返回修改后的完整提示词

**详细需求**：
- 在结果界面按Space进入修改模式
- 显示修改录音状态
- 录制用户的修改需求
- 将原提示词和修改需求发送给GPT-4
- 返回完整修改后的提示词(非diff)
- 支持多轮修改

**系统提示词模板**：
```
你是一个AI提示词修改专家。用户会提供一个原始提示词和修改需求，请根据修改需求对原始提示词进行调整，返回完整的修改后提示词。

原始提示词：{original_prompt}
修改需求：{modification_request}

请返回修改后的完整提示词：
```

**验收标准**：
- 修改理解准确率 ≥ 90%
- 修改后提示词质量不低于原版本
- 支持连续修改 ≥ 3轮

### 4.6 系统设置功能
**功能描述**：提供简单易用的配置界面

**详细需求**：
- API配置：Base URL、API Token
- 快捷键配置：支持录制新快捷键
- 启动设置：开机自启动、最小化启动
- 连接测试：验证API配置可用性
- 配置导入导出(备份恢复)

**验收标准**：
- 配置界面直观易用
- API测试准确可靠
- 配置保存到安全存储(Keychain)

## 5. 技术约束和系统要求

### 5.1 系统要求
- **操作系统**：macOS 12.0+
- **架构支持**：Intel x86_64 + Apple Silicon
- **权限需求**：麦克风访问、辅助功能访问
- **网络要求**：访问OpenAI API或自定义API端点

### 5.2 性能要求
- **启动时间**：冷启动 ≤ 2秒
- **内存占用**：空闲 ≤ 50MB，处理峰值 ≤ 100MB
- **响应时间**：快捷键响应 ≤ 100ms
- **处理时延**：语音转提示词 ≤ 3秒
- **电池消耗**：后台运行每小时 ≤ 2%

### 5.3 安全要求
- API密钥存储在macOS Keychain
- 音频数据处理后立即清除
- 不存储用户语音内容
- 支持HTTPS加密传输

## 6. 用户操作说明

### 6.1 基础使用
1. **激活录音**：按 Ctrl+M (可自定义)
2. **语音输入**：对着麦克风说出想法
3. **自动停止**：停止说话500ms后自动结束录音
4. **查看结果**：等待1-3秒后查看优化的提示词
5. **确认使用**：按 Enter 或点击"确认插入"按钮
6. **修改提示词**：按 Space 或点击"语音修改"按钮

### 6.2 高级操作
- **手动停止录音**：再次按快捷键或按 ESC
- **取消操作**：在结果界面按 ESC 或点击空白区域
- **多轮修改**：确认修改后可以继续按 Space 进行下一轮修改
- **设置访问**：点击菜单栏图标选择"设置"

### 6.3 故障排除
- **录音无反应**：检查麦克风权限和硬件连接
- **识别不准确**：在安静环境重试，说话清晰一些
- **网络错误**：检查网络连接和API配置
- **插入失败**：确认目标应用支持文本插入

## 7. 验收标准

### 7.1 功能验收
| 功能模块 | 验收标准 | 测试方法 |
|---------|---------|---------|
| 语音录制 | 快捷键响应≤100ms，VAD准确率≥95% | 自动化测试+手动验证 |
| AI处理 | 端到端处理≤3秒，准确率≥95% | API性能测试+质量评估 |
| 结果展示 | 界面美观，操作流畅 | UI测试+用户体验测试 |
| 文本插入 | 应用支持率≥95%，成功率≥99% | 兼容性测试 |
| 语音修改 | 修改理解准确率≥90% | 功能测试+边界测试 |

### 7.2 性能验收
| 性能指标 | 目标值 | 测试环境 |
|---------|-------|---------|
| 启动时间 | ≤2秒 | MacBook Pro M1, macOS 13 |
| 内存占用 | 空闲≤50MB | 连续运行24小时 |
| 响应时间 | ≤100ms | 快捷键到悬浮球显示 |
| 处理时延 | ≤3秒 | 语音到结果展示 |

### 7.3 质量验收
- **界面设计**：符合macOS Human Interface Guidelines
- **代码质量**：SwiftLint通过率100%，测试覆盖率≥80%
- **用户体验**：SUS可用性评分≥80分
- **稳定性**：连续使用8小时无崩溃

## 8. 版本规划

### 8.1 V1.0 (当前版本)
- 核心语音转提示词功能
- 基础UI和配置
- OpenAI API集成
- 基础错误处理

### 8.2 V1.1 (优化版本)
- 性能优化和稳定性提升
- 更多应用兼容性
- 用户反馈优化
- 本地缓存优化

### 8.3 V2.0 (增强版本)
- 本地语音模型支持
- 模板系统
- 使用统计和分析
- 团队配置同步

---

**文档状态**：开发版本  
**最后更新**：2025-07-25  
**审批状态**：待开发团队评审
#!/bin/bash

echo "ğŸ”§ Hello Prompt v2 - å¿«æ·é”®ä¿®å¤æµ‹è¯•"
echo "================================="
echo ""

# æ£€æŸ¥ç³»ç»Ÿ
if [[ "$OSTYPE" != "darwin"* ]]; then
    echo "âŒ æ­¤åº”ç”¨åªèƒ½åœ¨macOSä¸Šè¿è¡Œ"
    exit 1
fi

echo "ğŸ“¦ å¯åŠ¨ä¿®å¤åçš„åº”ç”¨..."
echo "âš ï¸  å¦‚æœå¿«æ·é”®æ­£å¸¸å·¥ä½œï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ï¼š"
echo "   1. åº”ç”¨æ­£å¸¸å¯åŠ¨å¹¶æ˜¾ç¤ºåˆå§‹åŒ–æ—¥å¿—"
echo "   2. æŒ‰ä¸‹ Ctrl+U åç«‹å³å¼¹å‡º'å¿«æ·é”®æµ‹è¯•'å¯¹è¯æ¡†"
echo "   3. åœ¨æ—¥å¿—ä¸­çœ‹åˆ°ğŸ™ï¸å¼€å§‹å½•éŸ³çš„ä¿¡æ¯"
echo "   4. å±å¹•ä¸­å¤®å‡ºç°Sirié£æ ¼çš„å½•éŸ³ç•Œé¢"
echo ""
echo "ğŸ¯ æµ‹è¯•æ­¥éª¤ï¼š"
echo "   1. ç­‰å¾…åº”ç”¨å®Œå…¨å¯åŠ¨"
echo "   2. æŒ‰ä¸‹ Ctrl+U æµ‹è¯•å¿«æ·é”®"
echo "   3. è§‚å¯Ÿæ˜¯å¦æœ‰å¼¹çª—å’Œå½•éŸ³ç•Œé¢"
echo "   4. æŒ‰ Cmd+Q é€€å‡ºåº”ç”¨"
echo ""
echo "ğŸš€ å¯åŠ¨åº”ç”¨..."

# å¯åŠ¨åº”ç”¨å¹¶æ˜¾ç¤ºå®æ—¶æ—¥å¿—
./.build/debug/HelloPromptV2 2>&1 | while IFS= read -r line; do
    # é«˜äº®é‡è¦çš„æ—¥å¿—ä¿¡æ¯
    if [[ "$line" == *"ğŸ™ï¸ å¿«æ·é”®è§¦å‘"* ]]; then
        echo "âœ… $line"
    elif [[ "$line" == *"å¿«æ·é”®æ³¨å†ŒæˆåŠŸ"* ]]; then
        echo "ğŸ¹ $line"
    elif [[ "$line" == *"å½•éŸ³ç•Œé¢"* ]]; then
        echo "ğŸ¬ $line"
    elif [[ "$line" == *"ERROR"* ]] || [[ "$line" == *"é”™è¯¯"* ]]; then
        echo "âŒ $line"
    elif [[ "$line" == *"WARNING"* ]] || [[ "$line" == *"è­¦å‘Š"* ]]; then
        echo "âš ï¸  $line"
    else
        echo "$line"
    fi
done